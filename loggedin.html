<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Reynold's Welcome</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="css/loggedin.css">
        <script>
            $.ajax({ //Verifies whether client is a logged in user, if not, returns to homepage
                type: 'POST',
                url: 'verifyuser',
                dataType: "json",
                success: function (data) {
                    if (data.status != 200)
                    {
                        window.location.replace("/");
                    }
                },
                error: function (xhr, status, error) {
                    window.location.replace("/");
                }
            });

            window.history.pushState("", "", '/loggedin.html');
            $(document).ready(function() {
              if (''.charAt(0) != '{')
              {
               /* message = document.getElementById('verifyMessage');
                message.style.display = "block";
                message.innerHTML = '';
                */
           

               startTime();
                //document.getElementById("demo").innerHTML = d;
              }
              
                function startTime()
                {
                        //onsole.log("it is coming to this functin");
                        let dateObj= new Date();
                        let month = dateObj.getMonth();
                        let monthStr = "";
                        if(month == 0)
                        {
                            monthStr = "January";
                        }
                        else if(month == 1)
                        {
                            monthStr = "Febuary";
                        }
                        else if(month == 2)
                        {
                            monthStr = "March";
                        }
                        else if(month == 3)
                        {
                            monthStr = "April";
                        }
                        else if(month == 4)
                        {
                            monthStr = "May";
                        }
                        else if(month == 5)
                        {
                            monthStr = "June";
                        }
                        else if(month == 6)
                        {
                            monthStr = "July";
                        }
                        else if(month == 7)
                        {
                            monthStr = "August";
                        }
                        else if(month == 8)
                        {
                            monthStr = "September";
                        }
                        else if(month == 9)
                        {
                            monthStr = "October";
                        }
                        else if(month== 10)
                        {
                            monthStr= "November"
                        }
                        else
                        {
                            monthStr = "December";
                        }
                        let weekday = dateObj.getDay();
                        let weekdayStr = "";
                        if(weekday == 1)
                        {
                            weekdayStr = "Monday";
                        }
                        else if(weekday == 2)
                        {
                            weekdayStr = "Tuesday";
                        }
                        else if(weekday == 3)
                        {
                            weekdayStr = "Wednesday";
                        }
                        else if(weekday == 4)
                        {
                            weekdayStr = "Thursday";
                        }
                        else if(weekday == 5)
                        {
                            weekdayStr = "Friday";
                        }
                        else if(weekday == 6)
                        {
                            weekdayStr = "Saturday";
                        }
                        else{
                            weekdayStr = "Sunday";
                        }
                        let year = dateObj.getFullYear();
                        let date  = dateObj.getDate();
                        let dateStr = date.toString();
                        let type = "";
                        if(dateStr.charAt(1) === '1')
                        {
                            type = "st"
                        }
                        else if(dateStr.charAt(1) === '2')
                        {
                            type = "nd";
                        }
                        else if(dateStr.charAt(1)=== '3')
                        {
                            type = "rd";
                        }
                        else
                        {
                            type = "th"
                        }
                        let hour =dateObj.getHours();
                        let centralTime  = "";
                        if(hour > 12 && hour<= 24)
                        {
                            hour = hour -12;
                            centralTime = "PM";
                            //hour = hour + centralTime;
                        }
                        else
                        {
                            centralTime = "AM";
                            //hour = hour + centralTime;
                        }
                        let minutes = dateObj.getMinutes();
                        let seconds = dateObj.getSeconds();
                        minutes = checkTime(minutes);
                        seconds = checkTime(seconds);
                        document.getElementById("demo").innerHTML = weekdayStr+ " " + monthStr + " " + date+type+ " " +year+ " " +  hour + ":" + minutes + ":" + seconds + " " + centralTime;
                        let clock = setTimeout(startTime,500);
                }
                function checkTime(i)
                {
                    if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
                        return i;
                }
            });

            function logout() {
                var cookies = document.cookie.split("; ");
                for (var c = 0; c < cookies.length; c++) {
                    var d = window.location.hostname.split(".");
                    while (d.length > 0) {
                        var cookieBase = encodeURIComponent(cookies[c].split(";")[0].split("=")[0]) + '=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain=' + d.join('.') + ' ;path=';
                        var p = location.pathname.split('/');
                        document.cookie = cookieBase + '/';
                        while (p.length > 0) {
                            document.cookie = cookieBase + p.join('/');
                            p.pop();
                        };
                        d.shift();
                    }
                }
                return true;
            }
        </script>
    </head>
    <body>
      <div class="wrapper">
            <nav class="navbar navbar-default">
                <div class="container-fluid">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="#" data-toggle="tab">View</a></li>
                        <li><a href="create.html">Create</a></li>
                        <li><a href="edit.html">Edit</a></li>
                        <li><a href="settings.html">Settings</a></li>
                        <li id="logout"><a href='/' onclick='return logout()'>Logout</a></li>
                    </ul>
                </div>
            </nav>

            <div class="contentWrapper">
                <div class="leftPane">
                    <div class ="item1">
                        <h2>SCHOOL OF COMPUTER SCIENCE</h2>
                        <!-- <h2>COMPUTER SCIENCE</h2> -->
                    </div>
                    <div class= "item2">
                            <h3 id= "demo"></h3>
                    </div>
                </div>

                <div class="rightPane">
                    <h1>Content Placeholder</h1>
                </div>
            </div>
        </div>
    </body>
    <!-- <h3>View</h3> -->
</html>
